{"version":3,"file":"contentScript.js","sources":["../../src/content/contentScript.tsx"],"sourcesContent":["// src/content/contentScript.tsx\nimport ReactDOM from \"react-dom\";\nimport \"@/styles/main.css\";\nimport { Idea } from \"@/types/idea\";\n\nconst hostId = \"my-extension-host\";\nlet host = document.getElementById(hostId);\n\nif (!host) {\n  host = document.createElement(\"div\");\n  host.id = hostId;\n  host.style.position = \"fixed\";\n  host.style.top = \"10px\";\n  host.style.right = \"10px\";\n  host.style.zIndex = \"10000\";\n  document.body.appendChild(host);\n}\n\nconst shadow = host.shadowRoot || host.attachShadow({ mode: \"open\" });\n\nconst containerId = \"my-root\";\nlet container = shadow.querySelector(`#${containerId}`);\n\nif (!container) {\n  container = document.createElement(\"div\");\n  container.id = containerId;\n  container.className = \"my-extension-root\";\n  shadow.appendChild(container);\n}\n\nif (!shadow.querySelector(\"link[href*='main.css']\")) {\n  const styleLink = document.createElement(\"link\");\n  // Print all the files in the dist folder\n\n  styleLink.rel = \"stylesheet\";\n  styleLink.href = chrome.runtime.getURL(\"styles/main.css\");\n  console.log(chrome.runtime.getURL(\"styles/main.css\"));\n  shadow.appendChild(styleLink);\n}\n\n// Example of how to communicate with the background script\nexport async function generateIdeas(): Promise<Idea[]> {\n  return new Promise((resolve, reject) => {\n    chrome.runtime.sendMessage({ type: \"GENERATE_IDEAS\" }, (response) => {\n      console.log(\"Response from background script:\", response);\n      if (chrome.runtime.lastError) {\n        reject(chrome.runtime.lastError);\n        return;\n      }\n      if (response.success) {\n        resolve(response.data as Idea[]);\n      } else {\n        reject(response.error);\n      }\n    });\n  });\n}\n\nexport async function getSession() {\n  return new Promise((resolve, reject) => {\n    chrome.runtime.sendMessage({ type: \"GET_SESSION\" }, (response) => {\n      if (chrome.runtime.lastError) {\n        reject(chrome.runtime.lastError);\n        return;\n      }\n      if (response.success) {\n        resolve(response.token);\n      } else {\n        reject(response.error);\n      }\n    });\n  });\n}\n\n// Function to create a post on Substack\nexport async function createSubstackPost(\n  message: string,\n  scheduleSeconds: number = 0,\n  autoCloseTab: boolean = true\n): Promise<any> {\n  return new Promise((resolve, reject) => {\n    chrome.runtime.sendMessage(\n      {\n        type: \"API_REQUEST\",\n        action: \"createSubstackPost\",\n        params: [message, scheduleSeconds, autoCloseTab],\n      },\n      (response) => {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n          return;\n        }\n        if (response.success) {\n          resolve(response.data);\n        } else {\n          reject(response.error);\n        }\n      }\n    );\n  });\n}\n\nwindow.addEventListener(\"message\", function (event) {\n  console.log(\"Message from content script:\", event);\n  if (event.source !== window) return; // we only care about messages from our own page\n  if (!event.data) return;\n\n  // Now forward it to the background script\n  chrome.runtime.sendMessage(event.data, function (response) {\n    console.log(\"Background script responded:\", response);\n  });\n});\n\nconsole.log(\"Content script loaded\");\n\n(async () => {\n  try {\n    console.log(\n      \"Substack detected. Time to grab cookies like a raccoon in a dumpster.\"\n    );\n\n    await new Promise((resolve, reject) => {\n      chrome.runtime.sendMessage(\n        { type: \"API_REQUEST\", action: \"setSubstackCookies\" },\n        (response) => {\n          console.log(\"Response from setSubstackCookies:\", response);\n          if (chrome.runtime.lastError) {\n            console.error(\n              \"Error from setSubstackCookies:\",\n              chrome.runtime.lastError\n            );\n            reject(chrome.runtime.lastError.message);\n            return;\n          }\n          if (response?.success) {\n            resolve(response.data.result); // it's a JSON string\n          } else {\n            reject(response?.error || \"Failed to get cookies\");\n          }\n        }\n      );\n    });\n\n    console.log(\"Cookies sent to WriteStack successfully\");\n  } catch (err) {\n    console.error(\"Something went sideways:\", err);\n  }\n})();\n"],"names":["hostId","host","document","getElementById","createElement","id","style","position","top","right","zIndex","body","appendChild","shadow","shadowRoot","attachShadow","mode","containerId","container","querySelector","className","styleLink","rel","href","chrome","runtime","getURL","console","log","window","addEventListener","event","source","data","sendMessage","response","Promise","resolve","reject","type","action","lastError","error","message","success","result","err"],"mappings":"AAKA,MAAMA,EAAS,oBACf,IAAIC,EAAOC,SAASC,eAAeH,CAAM,EAEpCC,IACIC,EAAAA,SAASE,cAAc,KAAK,EACnCH,EAAKI,GAAKL,EACVC,EAAKK,MAAMC,SAAW,QACtBN,EAAKK,MAAME,IAAM,OACjBP,EAAKK,MAAMG,MAAQ,OACnBR,EAAKK,MAAMI,OAAS,QACXC,SAAAA,KAAKC,YAAYX,CAAI,GAGhC,MAAMY,EAASZ,EAAKa,YAAcb,EAAKc,aAAa,CAAEC,KAAM,MAAO,CAAC,EAE9DC,EAAc,UACpB,IAAIC,EAAYL,EAAOM,cAAc,IAAIF,GAAa,EAEjDC,IACShB,EAAAA,SAASE,cAAc,KAAK,EACxCc,EAAUb,GAAKY,EACfC,EAAUE,UAAY,oBACtBP,EAAOD,YAAYM,CAAS,GAG9B,GAAI,CAACL,EAAOM,cAAc,wBAAwB,EAAG,CAC7CE,MAAAA,EAAYnB,SAASE,cAAc,MAAM,EAG/CiB,EAAUC,IAAM,aAChBD,EAAUE,KAAOC,OAAOC,QAAQC,OAAO,iBAAiB,EACxDC,QAAQC,IAAIJ,OAAOC,QAAQC,OAAO,iBAAiB,CAAC,EACpDb,EAAOD,YAAYS,CAAS,CAC9B,CAgEAQ,OAAOC,iBAAiB,UAAW,SAAUC,EAAO,CAC1CH,QAAAA,IAAI,+BAAgCG,CAAK,EAC7CA,EAAMC,SAAWH,SACjB,CAACE,EAAME,MAGXT,OAAOC,QAAQS,YAAYH,EAAME,KAAM,SAAUE,EAAU,CACjDP,QAAAA,IAAI,+BAAgCO,CAAQ,CAAA,CACrD,EACH,CAAC,EAEDR,QAAQC,IAAI,uBAAuB,GAElC,SAAY,CACP,GAAA,CACFD,QAAQC,IACN,uEACF,EAEA,MAAM,IAAIQ,QAAQ,CAACC,EAASC,IAAW,CACrCd,OAAOC,QAAQS,YACb,CAAEK,KAAM,cAAeC,OAAQ,sBACjBL,GAAA,CAERX,GADII,QAAAA,IAAI,oCAAqCO,CAAQ,EACrDX,OAAOC,QAAQgB,UAAW,CAC5Bd,QAAQe,MACN,iCACAlB,OAAOC,QAAQgB,SACjB,EACOjB,EAAAA,OAAOC,QAAQgB,UAAUE,OAAO,EACvC,MACF,CACIR,GAAAA,MAAAA,EAAUS,QACJT,EAAAA,EAASF,KAAKY,MAAM,EAErBV,GAAAA,GAAAA,YAAAA,EAAUO,QAAS,uBAAuB,CACnD,CAEJ,CAAA,CACD,EAEDf,QAAQC,IAAI,yCAAyC,QAC9CkB,GACCJ,QAAAA,MAAM,2BAA4BI,CAAG,CAC/C,CACF,GAAG"}